<!Doctype html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>R 教程 | 生物慕课网</title>

<link rel="canonical" href="http://www.biomooc.com/R/R-tutorial.html" />
<meta name="keywords" content="R 绘图教程,R低水平绘图命令">
<meta name="description" content="R 绘图教程,R低水平绘图命令。">
		
	<link rel="shortcut icon" href="/img/favicon.ico" mce_href="/img/favicon.ico" type="image/x-icon" >
	<link rel="stylesheet" href="/wp-content/themes/biomooc/style.css?v=1.141" type="text/css" media="all" />	
	<link rel="stylesheet" href="/static/css/font-awesome.min.css" media="all" />	
<!--
	<link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" media="all" />	  
-->
  <!--[if gte IE 9]><!-->
  <script src="/static/js/jquery.min.js"></script>
  <!--<![endif]-->
  <!--[if lt IE 9]>
     <script src="//cdn.bootcss.com/jquery/1.9.1/jquery.min.js"></script>
     <script src="//cdn.bootcss.com/html5shiv/r29/html5.min.js"></script>
  <![endif]-->
  <link rel="apple-touch-icon" href="/img/mobile-icon.png"/>
  <meta name="apple-mobile-web-app-title" content="生物慕课网">
<style>
.red{color:red}
.orange{color:orange}
.blue{color:blue}
.lime{color:lime}

.notice{background:red; color:white; padding:5px; margin:10px; 
	font-size:large; font-size: 15px!important;font-weight: bold;
}

h2{margin-top:30px!important;}
h3, h4{ border-left:3px solid #E5502A; padding-left:3px; margin-top:20px!important;}

/*本页R代码过长: 最长n px,超过了出现滚动条*/
.notranslate{max-height:400px; overflow-y:scroll;}

p{text-indent:2em;}
</style>
</head>


<body>
<!-- 头尾自动加载 -->
<script>
$(function(){
	$.get('/part/header-nav.html',function(data,status){
		$('body').prepend(data);//header-nav
	});
	
	$('<div id="footer" class="mar-t50"></div>').appendTo($("body"));
	$("#footer").load("/part/footer.html"); //footer
	
	$.get('/part/right-bottom-btn.html',function(data,status){
		$('#footer').after(data);//右下角按钮
	});

	
			
	//左右菜单
	$.get('./part/menu-left.html',function(data,status){
		$('.main .row').first().prepend(data);//左侧菜单-本文件夹内使用
	});
	
	$.get('/part/menu-right.html',function(data,status){
		$('.main .row').first().append(data);//右侧菜单-全局通用
		//没有事件，还需要绑定事件
		
		
	});
	
	$.getScript("/wp-content/themes/biomooc/assets/js/main.js?v=1.15");//回到顶部js文件
});
</script>


	
	

<!--  内容  -->
<div class="container main">
	<!-- 中间 -->
	<div class="row">
	





<div class="col middle-column">
		
	
	<div class="article">
			<div class="article-heading-ad" style="display: none;">
		
		</div>
		<div class="previous-next-links">
			<div class="previous-design-link"><i style="font-size:16px;" class="fa fa-arrow-left" aria-hidden="true"></i> <a href="/R/R-intro.html" rel="pre">R 简介</a> </div>
			<div class="next-design-link"><a href="/R/R-intro.html" rel="next"> R 简介</a> <i style="font-size:16px;" class="fa fa-arrow-right" aria-hidden="true"></i></div>
		</div>
		<div class="article-body">
		
			<div class="article-intro" id="content">
			
			<h1><span class="color_h1">R统计 </span> 常见的分布</h1>



<h2 class="tutheader">目录</h2>
<p><b>要点</b>: 概率函数，通常用来生成特征已知的模拟数据，以及在用户编写的统计函数中计算概率值。<br>
[R In Action, 2nd, Chapter5.2.3][R语言与统计分析 汤银才 chapter3.3]</p>
<p class="notice">注意: 不同信息源在定义同一个概率时常常有细微的差异，本文讲解时都以R stats中的定义为准。</p>

<ul>
	<li><a href="#1">概率函数概述</a></li>
	<li><a href="#2">离散型概率分布</a>
		<ul>
			<li><a href="#2_1">二项分布/负二项分布</a></li>
			<li><a href="#2_2">泊松分布</a></li>
			<li><a href="#2_3">几何分布/超几何分布</a>
				<ul>
					<li><a href="#2_3_GO">超几何分布在基因富集分析中的应用</a></li>
				</ul>
			</li>
		</ul>
	</li>
	
	<li><a href="#3">连续型概率分布</a>
		<ul>
			<li><a href="#3_1">均匀分布</a></li>
			<li><a href="#3_2">指数分布</a></li>
			<li><a href="#3_3">正态分布 与 对数正态分布 (log normal distribution)</a></li>
			<li><a href="#3_4">Gamma 分布</a></li>
		</ul>
	</li>	
	<li><a href="#4">三大抽样分布</a>
		<ul>
			<li><a href="#4_1">卡方分布</a></li>
			<li><a href="#4_2">t分布</a></li>
			<li><a href="#4_3">F分布</a></li>
		</ul>
	</li>
	<li><a href="#5">分布之间的关系</a></li>
	<li><a href="#6">大数定理、中心极限定理</a></li>
	<li><a href="#100">参考资料</a></li>
</ul>

<p>α β</p>




<a name="1"></a>
<h2 class="tutheader">概率函数概述</h2>

<p>[dpqr]distribution_abbreviation()<br>
在R中，一般一种分布包含4个固定格式的函数，第一个字母表示其所指分布的某一方面:</p>
<pre>
d = 密度函数(density)
p = 分布函数(distribution function)
q = 分位数函数(quantile function)
r = 生成随机数(随机偏差)
</pre>

<p>Base R provides 
<b class="red">probability distribution functions p foo (), </b>
<b class="orange">density functions d foo (), </b>
<b class="blue">quantile functions q foo (), </b>
<b class="lime">and random number generation r foo () </b>

where foo indicates the type of distribution: <br />
beta ( foo = beta), binomial binom, Cauchy cauchy, chi-squared chisq, exponential exp, Fisher F f, gamma gamma, geometric geom, hypergeometric hyper, logistic logis, lognormal lnorm, negative binomial nbinom, normal norm, Poisson pois, Student t t, uniform unif, Weibull weibull. </p>

<p>Following the same naming scheme, but somewhat less standard are the following distributions in base R: probabilities of coincidences (also known as "birthday paradox") birthday (only p and q), studentized range distribution tukey (only p and q), Wilcoxon signed rank distribution signrank, Wilcoxon rank sum distribution wilcox.</p>

<br>
<p>离散型随机分布: 二项分布、几何分布、超几何分布、泊松分布等。</p>
<p>连续型随机分布: 正态分布、均匀分布、指数分布、对数正态分布、柯西分布、Gamma分布、瑞利分布、韦伯分布等。</p>
<p>三大抽样分布: 卡方分布、F分布、t分布。</p>

<br>


<table class="reference" style="width:100%">
<tbody><tr>
	<th><strong>distribution</strong></th>
	<th><strong>R name </strong></th>
	<th><strong>distribution</strong></th>
	<th><strong>R name </strong></th>
  </tr>
  <tr>
	<td><strong>Beta</strong></td>
	<td>beta</td>
	<td><strong>Lognormal 对数正态分布</strong></td>
	<td>lnorm</td>
  </tr>
  <tr>
	<td><strong>Binomial 二项分布</strong></td>
	<td>binom</td>
	<td><strong>Negative Binomial 负二项分布</strong></td>
	<td>nbinom</td>
  </tr>
  <tr>
	<td><strong>Cauchy 柯西分布</strong></td>
	<td>cauchy</td>
	<td><strong>Normal 正态分布</strong></td>
	<td>norm</td>
  </tr>
  <tr>
	<td><strong>Chisquare (非中心)卡方分布</strong></td>
	<td>chisq</td>
	<td><strong>Poisson 泊松分布</strong></td>
	<td>pois</td>
  </tr>
  <tr>
	<td><strong>Exponential 指数分布</strong></td>
	<td>exp</td>
	<td><strong>Student t </strong></td>
	<td>t</td>
  </tr>
  <tr>
	<td><strong>F</strong></td>
	<td>f</td>
	<td><strong>Uniform 均匀分布</strong></td>
	<td>unif</td>
  </tr>
  <tr>
	<td><strong>Gamma</strong></td>
	<td>gamma</td>
	<td><strong>Tukey</strong></td>
	<td>tukey</td>
  </tr>
  <tr>
	<td><strong>Geometric 几何分布</strong></td>
	<td>geom</td>
	<td><strong>Weibull</strong></td>
	<td>weib</td>
  </tr>
  <tr>
	<td><strong>Hypergeometric 超几何分布</strong></td>
	<td>hyper</td>
	<td><strong>Wilcoxon</strong></td>
	<td>wilcox</td>
  </tr>
  <tr>
	<td><strong>Logistic</strong></td>
	<td>logis</td>
	<td>多项式分布</td>
	<td>nultinom</td>
  </tr>
</tbody>
</table>







<a name="2"></a>
<h2 class="tutheader">离散型概率分布</h2>












<a name="2_3"></a>
<h2 class="tutheader">几何分布和超几何分布</h2>

<h3 class="tutheader">几何分布(Geometric distribution) X~G(p): geom(p)</h3>
<p>几何分布	 geom	 p:一次试验中事件发生的概率</p>
<p>意义: 努里试验独立地重复进行, 一直到出现有成功出现时停止试验, 则试验失败的次数X=k服从一个参数为p的几何分布.</p>

<p>分布律: f(x|p)=p*(1-p)^x, x=0,1,2,...,  p取值范围是(0,1]</p>
<p>数字特征: E(X)=(1-p)/p; var(X)=(1-p)/p^2</p>
<p>本文是R语言中的几何分布的定义。也有些教科书定义为第k2次试验才成功的概率，显然k2=k+1。分布律和数字特征都需要相应调整。</p>

<div class="code notranslate">
	<div style="white-space: pre-wrap;"># 几何分布
p=0.3
hist( rgeom(1000, p), n=20 )
#数字特征
mean(rgeom(1000, p)) #(1-p)/p
var(rgeom(1000, p)) #(1-p)/p**2
#
colors=rainbow(6)
x=1:50;
plot(NULL, xlim=c(0,30), ylim=c(0,0.25), 
     xlab="X", ylab="density", main="X~G(p)")
ps=seq(0.1,1,0.2)
for(i in 1:length(ps) ){
  p=ps[i]
  lines(x,dgeom(x,p), type="o", cex=0.5, col=colors[i])
}
legend('topright', lty=1, title = "p",
       col=colors[1:length(ps)], legend=ps)</div>
</div>
<br>

<img src="images/stat_density/dgeom.png"><br>
<p>超几何分布跟二项分布的区别：抽取n个的过程中，抽得特定种类的概率会变化（因为不归还），但抽完后每个组合的发生概率是一样的。而二项分布重复n次实验，每次概率不变。</p>







<h3 class="tutheader">超几何分布(hypergeometric distribution) hyper(M, N, k): 不放回取样</h3>
<p>意义: 从装有M个白球和N个黑球的罐子中不放回地取出k(&lt; N + M)个球, 则其中的白球数X=x服从超几何分布。</p>
<p>超几何分布：N+M中有M个特定种类，抽取k个时，会有x个特定种类的概率。</p>

<p>p(x) = choose(m, x) * choose(n, k-x) / choose(m+n, k),  x = 0, …, k. <br />
Note that p(x) is non-zero only for max(0, k-n) <= x <= min(k, m).</p>

<p>数字特征: 记p=M/(N+M); E(X)=k*p; var(X)=(N+M-k)/(N+M-1) * k*p*(1-p) </p>

<div class="code notranslate">
	<div style="white-space: pre-wrap;"># 超几何分布
T=1000; p=0.1; k=3; 
M=T*p #目标集合
N=T*(1-p) #非目标集合
hist( rhyper(1000, M,N,k), n=20 )
#数字特征
mean( rhyper(1000, M,N,k) ) #k*p
var( rhyper(1000, M,N,k) ) #(N+M-k)/(N+M-1) * k*p*(1-p)

# 密度曲线
ps=c(0.01,0.03,0.05,0.07, seq(0.1,1,0.2),1)
colors=rainbow(length(ps)*1.2)
x=1:50; T=200; k=40
plot(NULL, xlim=c(0,k+1), ylim=c(0,1.2), 
     xlab="X", ylab="density", main="X~hyper(M,N,k)")
for(i in 1:length(ps) ){
  p=ps[i]; M=T*p;  N=T*(1-p);
  lines(x,dhyper(x, M,N,k), type="o", cex=0.5, col=colors[i])
}
legend('topleft', lty=1, title = "hyper(M,N,k)", bty='n', 
	   legend=paste0( T*ps,", ",T*(1-ps), ', ', k, '(p=',ps,')' ),
	   col=colors[1:length(ps)] )</div>
</div>

<br><b>扩展资料</b><br>
<p>如果样本容量k=1，即从有限总体中只抽取一个个案，且恰好抽到符合要求个案的概率，那么超几何分布可以还原成二项分布。</p>
<p>如果数据总体的容量(N+M)无穷大，也就是将有限总体换成无限总体，此时抽中的个案放回与不放回对于总体中符合要求的个案比例都没有影响，超几何分布也可视为二项分布。</p>
<p>在实际应用时，只要数据总体的个案数目是样本容量的10倍以上，即(N+M)>10*k，就可用二项分布近似描述超几何分布，通过两种概率质量函数计算得到的概率几乎相同。</p>
<br />




<a name="2_3_GO"></a>
<br><b>超几何分布在基因富集分析中的应用</b><br>
<p>Hypergeometric test are useful for enrichment analysis. 超几何分布 常用于基因富集分析。总基因集合(N+M个基因)中，某通路基因有M个，则随机取出k个基因，包含某通路的基因个数为X=x的分布。其p值就是更极端情况的概率，也就是包含某通路的基因数大于k的概率p{X>x}。如果做了多次test，还需要对p做矫正。</p>
<div class="code notranslate">
	<div style="white-space: pre-wrap;">实例: phyper(q, m, n, k, lower.tail = TRUE, log.p = FALSE)
#pop size : 5260 总基因数
#Number of items in the pop that are classified as successes : 1998 某个通路的基因数
#
#sample size : 131 取样数量
#Number of items in the sample that are classified as successes : 62 取样中包含的某个通路的基因数
#
#To compute a hypergeometric test, is that correct?
phyper(62, 1998, 5260-1998, 131) #[1] 0.9892471
### or
#P(Observed 62 or more) = 1-P(Observed less than 62).
1 - phyper(62-1, 1998, 5260-1998, 131) #[1] 0.01697598
phyper(62-1, 1998, 5260-1998, 131,lower.tail=F) #[1] 0.01697598

#(1) 4 method to get the p value:
sum( dhyper(62:131, 1998, 5260-1998, 131) )
1-sum( dhyper(0:61, 1998, 5260-1998, 131) )
phyper(62-1, 1998, 5260-1998, 131, lower.tail=FALSE)
1-phyper(62-1, 1998, 5260-1998, 131, lower.tail=T) #0.01697598


#(2) 或者使用 fisher检验，其背后也是超几何检验，结果p值是一致的。
# 先建立列联表，按照2种标准把总体基因分类，横着为是否被取样，竖着为是否为成功样品。排列如下: 
# a b 
# c d
a=62; b=131-a; c=1998-a;
d=5260-131-c
5260-1998-b #also d

mt=data.frame(
  'inPathway'=c(a,c),
  'notInPathway'=c(b,d)
)
rownames(mt)=c('DEG', 'notDE')
mt
#       inPathway notInPathway
# DEG          62           69
# notDE      1936         3193

# 默认是双端，p值较大
fisher.test(mt)$p.value #0.02857428
fisher.test(mt, alternative='two.sided')$p.value #0.02857428

# 这里需要指定是单端test，指定alternative='greater'后，p值和之前phyper计算结果一致
fisher.test(mt, alternative='greater')$p.value # 0.01697598</div>
</div>
<p><b>Note</b>: lower.tail使用的逻辑为： if TRUE (default), probabilities are P[X ≤ x], otherwise, P[X > x]. <p>



<br>
<p>使用 permutation test(置换检验?) 进行1万次模拟抽样，在5260个整数中随机抽样，统计小于1998的个数的分布。</p>
<img src="images/stat_density/dgeom_permutation.png">
<div class="code notranslate">
	<div style="white-space: pre-wrap;"># permutation test
a1=1:5260
#
num=c()
for(i in 1:10000){  #模拟1万次
  a2=sample(a1, 131) #随机抽取131个
  a3=length( a2[a2<1998] ) #小于1998的个数
  num=c(num, a3 )
}
hist(num, n=50, prob=TRUE)
lines(density(num), col='red')
#sd(num)
#mean(num)
abline(v=mean(num)+2*sd(num), lty=2, col='red')
abline(v=mean(num)-2*sd(num), lty=2, col='red')
#
abline(v=62, lty=3, col='blue') #62个确实在尾巴位置

# 直接计算临界值， 发现62确实超过0.05临界值，属于小概率事件
#(x-mu)/sd ~N(0,1)
qnorm( 0.95, 0, 1) * sd(num) + mean(num) #58.80205
qnorm( 0.95, mean(num), sd(num)) #58.80205</div>
</div>
<p>进一步阅读: 
	<a target="_blank" href="https://www.jianshu.com/p/13f46bebebd4">浅探富集分析中的超几何分布</a> |  
	<a target="_blank" href="https://blog.csdn.net/linkequa/article/details/86491665">超几何分布检验（hypergeometric test）</a> | 
	<a target="_blank" href="https://stackoverflow.com/questions/8382806/hypergeometric-test-phyper">Hypergeometric test (phyper)</a> | 
	<a target="_blank" href="http://mengnote.blogspot.com/2012/12/calculate-correct-hypergeometric-p.html">Hypergeometric test和fisher检验是一致的</a> | 
</p>










<a name="3"></a>
<h2 class="tutheader">连续型概率分布</h2>



<a name="3_3"></a>
<h2 class="tutheader">正态分布 N(mu, sigma^2)</h2>
<p>正态分布（Normal distribution），也称“常态分布”，又名高斯分布（Gaussian distribution）。</p>
<p>正态曲线呈钟型，两头低，中间高，左右对称因其曲线呈钟形，因此人们又经常称之为钟形曲线。</p>
<p>若随机变量X服从一个数学期望为μ、方差为σ^2的正态分布，记为N(μ，σ^2)。其概率密度函数为正态分布的期望值μ决定了其位置，其标准差σ决定了分布的幅度。当μ = 0,σ = 1时的正态分布是标准正态分布。</p>
<div class="code notranslate">
	<div style="white-space: pre-wrap;">x=seq(-5,5,0.1)
#画坐标系
plot(NULL, xlim=c(-5, 5), ylim=c(0,1), xlab="X", ylab="density", 
     main=expression( paste( N(mu, sigma^2)) ) )
sds=c(0.5, 1, 1.5, 2, 2.5, 1.5)
mus=c(0,0,0,0,0,-2)
n=length(sds)
colors=c('grey', 'red','orange','green','blue','cyan' )
# 画线
for(i in 1:n){
  y=dnorm(x, mean=mus[i], sd=sds[i])
  lines(x,y, type='l', cex=0.5, col=colors[i]) 
}
legend('topright', col=colors, lty=1,
       legend=paste0("mu=",mus,', sd=',sds), bty='n')</div>
</div>
<img src="images/stat_density/dnorm.png"><br>
<p>正态分布为什么常见？真正原因是中心极限定理（central limit theorem）: "多个独立统计量的和的平均值，符合正态分布。" 根据中心极限定理，如果一个事物受到多种因素的影响，不管每个因素本身是什么分布，它们加总后，结果的平均值就是正态分布。</p>



<h3 class="tutheader">对数正态分布 (log normal distribution)</h3>
<p>为什么收入分布右侧有长尾，而不是对称的？因为人的收入受到的影响(比如有钱人其家庭、教育、运气、工作、人脉等)不是独立的，而是互相加强的。这些因素对结果的影响不是相加，而是相乘，那么最终结果不是正态分布，而是对数正态分布（log normal distribution），即x的对数值log(x)满足正态分布。</p>
<p>对数正态分布X是一种连续概率分布，其随机变量的对数ln(X)服从正态分布。或者说如果Y=ln(X)~N(mu,sigma^2)符合正态分布，则称X=exp(Y)~LN(mu, sigma^2)符合对数正态分布。其中mu和sigma不是对数正态分布的均值和标准差，而分别称它为对数均值和对数标准差。</p>
<p>数字特征: E(X) = exp(μ + 1/2 * σ^2);  Var(X) = exp(2*μ + σ^2)*(exp(σ^2) - 1)</p>


<div class="code notranslate">
	<div style="white-space: pre-wrap;">mu1=0.4;sig1=0.5;aa=rlnorm(100000, meanlog=mu1, sdlog=sig1)
exp(mu1 + 1/2 * sig1^2) - mean(aa) ##对数正态分布的数字特征
exp(2*mu1 + sig1^2)*(exp(sig1^2) - 1) - var(aa)
#
mean(log(aa)) #0.4 对数均值
sd(log(aa)) #0.5 对数标准差
#
hist(aa, n=100, freq = F, xlim=c(-1, 5))
hist(aa, n=100) #对数正态分布
hist(log(aa), n=100) #取对数后,符合正态分布

# 密度曲线
x=seq(-1,6,0.01)
plot(NULL, xlim=c(0,2.5), ylim=c(0,4),
     main="X~LN(meanlog, sdlog^2)", xlab="X", ylab="density")
sds=c(0.125, 0.25, 0.5, 1, 1.5, 10); n=length(sds)
colors=c('grey','black', 'red', 'orange', 'green', 'blue')
#
for(i in 1:n){
  y=dlnorm(x, meanlog = 0, sdlog = sds[i])
  lines(x,y,type="l", col=colors[i])
}
legend('topright', col=colors, lty=1, bty='n', title="sdlog=0",
       legend=paste0( "sdlog=", sds ))</div>
</div>
<br>
<hr>

<p><b>问题: 对数正态分布的数字特征和 对应的正态分布的数字特征之间的关系？</b></p>
<img src="images/stat_density/dlnorm.png"><br>
<div class="code notranslate">
	<div style="white-space: pre-wrap;">x=seq(0.01,100,0.01);
mu=0.4; sigma=0.5;
y=dlnorm(x, meanlog = mu, sdlog = sigma)
plot(x,y,type="l", lty=2, col='red', xlim=c(-1.5,4)) # 对数正态分布
lines(log(x), y, type="l", col="blue") #!! 这样搞错误，因为x均匀分布。我们要操作随机变量！

######### 重新画图:
#其随机变量的对数服从正态分布，要先模拟出随机变量X，然后再看ln(X)的分布
set.seed(20200629)
aa=rlnorm(10000, meanlog=mu, sdlog=sigma)
hist(aa, n=40, freq=F, col="#FF000022",
     xlim=c(-1.5,5), ylim=c(0,0.9), xlab="X",main="") #随机变量的分布
lines(x,y,type="l", col='red') #X~LN(mu, sigma^2) #参数生成的概率密度曲线

# ln(X)~LN(mu, sigma^2)
hist( log(aa), n=20, freq=F, col="#0000FF22", add=TRUE) #随机变量的分布
x1=seq(-3,4,0.1); y1=dnorm(x1, mean=mu, sd=sigma )
lines(x1, y1, col="blue", lwd=1) #参数生成的概率密度曲线
abline(v=mu, col='blue', lty=2, lwd=2)
#
legend('topright', lty=1, col=c('red','blue'), bty="n",
       legend=c("X~LN(mu,sigma^2)", "ln(X)~N(mu,sigma^2)"))</div>
</div>
<p>由以上模拟来看，X~LN(mu,sigma^2) 和 ln(X)~N(mu,sigma^2) 的参数完全相等。</p>




<a name="3_4"></a>
<h2 class="tutheader">伽玛分布 / 伽马分布 gamma(shape, scale)</h2>
<p>意义: (1)“gamma分布，表示等到n个随机事件都发生，需要的时间。”(2)k个相互独立的参数为1/b的指数分布的和服从参数为(k,b)的伽玛分布。</p>
<p>伽马分布 gamma(a,b) 有两个参数，a代表形状(shape parameter)，b代表尺度(scale parameter)</p>
密度函数: <img src="images/stat_density/gamma.png"><br><br>
<p>数字特征: EX=a*b; Var(X)=a*b*b;所以 alpha=Mean^2/Variance,  beta=Variance/Mean</p>
<p>dgamma(x, shape, rate = 1, scale = 1/rate, log = FALSE); 默认第三个参数是rate，要特别指定scale参数。</p>
<pre>
a=2;b=0.5; d1=rgamma(100000, shape=a, scale=b);hist(d1)
m1=mean(d1);m1 #[1] 1.000316
s1=var(d1);s1 #[1] 0.5022628
#
a*b #m1 1
a*b*b #s1 0.5
</pre>

<p>alpha （一般为整数）代表一件事发生的次数；beta代表它发生一次的概率（或者叫速率）。那么gamma 分布就代表这么一件事发生alpha 次所需要时间的分布。</p>
<p>特例: alpha=1时是指数分布; a=n/2, b=2 时的分布为卡方分布。</p>

<p>可以使用Gamma分布描述位点的进化速度。当alpha > 1时，分布呈钟形，表示大部分位点的进化速率位于均值附近，趋于一致；当alpha &lt;= 1时，分布为一个高度倾斜的L形，表示大部分位点的进化速率非常低，只有少部分位点属于进化的热点。一般情况下，对于真实的多序列比对数据，不同位点其碱基替换率是不一致的，推荐设置alpha = 0.5。</p>


<br>
<p><b>冗余系统（standby redundant system）</b>
假设有一个系统有个部件，但实际需要的只有一个（其余的是备用）。当一个部件失效时，另一个自动接管。因此，只有当所有个部件都失效时，系统才会崩溃。在一定假设下，Gamma分布可以用来描述这样一个系统的寿命。</p>


<div class="code notranslate">
	<div style="white-space: pre-wrap;">#step1 产生服从伽马分布gamma(2,1)的数据。
x = seq(0,6,length.out=100)
y = dgamma(x,2,scale=1)

#step2 采用plot函数~绘制gamma分布函数图的第一条曲线。
plot(x, y, main="the Gamma Density Distribution",
     ylab="PDF",
     xlim = c(0,6),ylim = c(0,1) ,col = "red" , type="l",lwd=2)
#绘制第一个gamma分布函数图，增加键值，使图形变得美观。

#step3 为了观察参数不同时gamma分布的密度函数，采用lines函数。
lines(x,dgamma(x,1,scale=0.5),col="grey",lwd=2)
lines(x,dgamma(x,1.5,scale=0.5),col="orange",lwd=2)
lines(x,dgamma(x,2,scale=0.5),col="blue",lwd=2)

# step4 图例
color2=c("red","gray","orange","blue");
legend(x=3.5,y=0.9, bty="n", 
       legend = paste0("α=", c(2,1,1.5,2), ", β=" , c(1,0.5,0.5,0.5)) , 
       lwd = 2, col = color2)

# step5 增加图注
text(2,0.3,"gamma(2,β=1)",pos=4,cex=0.9, col=color2[1])
text(0.3,1,"gamma(1,β=0.5)",pos=4,cex=0.9, col=color2[2])
text(0.6,0.8,"gamma(1.5,β=0.5)",pos=4,offset=-0.05,cex=0.9, col=color2[3])
text(1,0.5,"gamma(2,β=0.5)",pos=4,cex=0.9, col=color2[4])

#http://blog.sina.com.cn/s/blog_c1e323d40102wyg3.html 原文用rate，本文改为beta/scale</div>
</div>
<img src="images/stat_density/dgamma.png"><br>
<p>gamma分布参数有点多，又有积分，公式上看起来挺复杂，和其他很多分布有着千丝万缕的联系，比如指数分布、泊松分布、正态分布、对数正态分布。<br>
可以脑洞大开地想: 伽玛分布=指数分布＊泊松分布。看看pdf的表达式，自己换一个写法就会发现伽玛把exponential和poisson的公式揉到一起了。</p>

<p>延伸阅读: 
<a target=_blank href="https://cosx.org/2014/07/gamma-function-1/">神奇的伽玛函数(上)</a>,
<a target=_blank href="https://cosx.org/2014/07/gamma-function-2/">(下)</a>.</p>











<a name="4"></a>
<h2 class="tutheader">三大抽样分布</h2>


<a name="4_2"></a>
<h2 class="tutheader">t分布</h2>
<div class="code notranslate">
	<div style="white-space: pre-wrap;"># Display the Student's t distributions with various
# degrees of freedom and compare to the normal distribution

x = seq(-4, 4, length=100)
hx = dnorm(x)

degf = c(1, 3, 8, 30)
colors = c("red", "blue", "darkgreen", "gold", "black")
labels = c("df=1", "df=3", "df=8", "df=30", "normal")

plot(x, hx, type="l", lty=2, xlab="x value",
     ylab="Density", main="Comparison of t Distributions")

for (i in 1:4){
  lines(x, dt(x,degf[i]), lwd=2, col=colors[i])
}

legend("topright", inset=.05, title="Distributions",
       bty="n", #不要图例边框
       labels, lwd=2, lty=c(1, 1, 1, 1, 2), col=colors)</div>
</div>
<img src="images/stat_density/dt.png"><br><br>
<p>t分布比着正态分布扁平，但是随着df的增大而变尖，df=30时接近正态分布。</p><br>







<a name="100"></a>
<h2 class="tutheader">参考资料</h2>
<pre>
> Probability Plots
https://www.statmethods.net/advgraphs/probability.html

> CRAN Task View: Probability Distributions
https://cran.r-project.org/web/views/Distributions.html
> Distributions in the stats package
https://stat.ethz.ch/R-manual/R-devel/library/stats/html/Distributions.html

> 6 Common Probability Distributions every data science professional should know
https://www.analyticsvidhya.com/blog/2017/09/6-probability-distributions-data-science/

> Probability distributions in R
https://www.r-bloggers.com/probability-distributions-in-r/


> Distribution is all you need
https://baijiahao.baidu.com/s?id=1645256431232755893&wfr=spider&for=pc
项目地址：https://github.com/graykode/distribution-is-all-you-need


> 各种分布之间的关系
https://www.zhihu.com/question/34866983


> Gamma Distribution in R
https://statisticsglobe.com/gamma-distribution-in-r-dgamma-pgamma-qgamma-rgamma
https://www.tutorialspoint.com/statistics/gamma_distribution.htm


> 数理统计中的估计问题
http://blog.sina.com.cn/s/blog_c1e323d40102x1rl.html

## pdf
> Table of Common Distributions
http://www.stat.tamu.edu/~twehrly/611/distab.pdf

> 几种常见的分布
https://wenku.baidu.com/view/ab59abb8c77da26925c5b0a3.html

> FITTING DISTRIBUTIONS WITH R
http://www.pitt.edu/~super1/ResearchMethods/Ricci-distributions-en.pdf


</pre>






			</div>
		</div>
		
		<div class="previous-next-links">
			<div class="previous-design-link"><i style="font-size:16px;" class="fa fa-arrow-left" aria-hidden="true"></i> <a href="/R/R-intro.html" rel="pre">R 简介</a> </div>
			<div class="next-design-link"><a href="/R/R-intro.html" rel="next"> R 简介</a> <i style="font-size:16px;" class="fa fa-arrow-right" aria-hidden="true"></i></div>
		</div>
	</div>
</div>







	
	
	
	
	










</div>

</div>

</body>
</html>